---
import '../styles/global.css';
import Header from '../components/layout/Header.astro';
import Sidebar from '../components/layout/Sidebar.astro';
import MobileMenu from '../components/ui/MobileMenu';
import MobileNavigation from '../components/layout/MobileNavigation.astro';

export interface Props {
  title: string;
  description?: string;
}

const { title, description = "OpenAI-style sidebar navigation template" } = Astro.props;
const currentPath = Astro.url.pathname;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>{title}</title>
    
    <!-- Prevent dark mode flash -->
    <script is:inline>
      // This runs before the page renders to prevent flash
      (function() {
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
          document.documentElement.classList.add('dark');
        }
      })();
    </script>
  </head>
  <body class="bg-surface">
    <div class="sidebar-layout">
      <!-- Desktop Column 1: Spacer (hidden on mobile) -->
      <div class="hidden md:block"></div>
      
      <!-- Desktop Column 2: Sidebar area (hidden on mobile) -->
      <Sidebar currentPath={currentPath} />
      
      <!-- Mobile: Column 1 / Desktop: Column 3 - Main Content Area -->
      <main class="flex min-h-screen w-full flex-col bg-surface">
        <!-- Mobile Header -->
        <Header title="Navigation">
          <MobileMenu client:load>
            <MobileNavigation currentPath={currentPath} />
          </MobileMenu>
        </Header>
        
        <!-- Content Wrapper -->
        <div class="mx-auto w-full max-w-container px-6 py-8 md:py-12 lg:px-8">
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12">
              <slot />
            </div>
          </div>
        </div>
      </main>
    </div>
  </body>
</html>